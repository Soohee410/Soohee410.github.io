---
layout: post
title: "[ì„ í˜•ëŒ€ìˆ˜] Singular Value Decomposition, Pseudoinverse"
tags: [Linear Algebra]
use_math: true
---
ì•ˆë…•í•˜ì„¸ìš”! ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ”  **íŠ¹ì´ê°’ ë¶„í•´(Singular Value Decomposition)** ì™€ **Pseudoinverse** ì— ëŒ€í•œ ë‚´ìš©ì„  ì •ë¦¬í•˜ê³ ì í•©ë‹ˆë‹¤. ë°”ë¡œ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤ ğŸ˜Š
<br>

## 1.  ì§ì‚¬ê°í–‰ë ¬(Rectangular Matrix)ì— ëŒ€í•˜ì—¬
<br>

ì•ì„  í¬ìŠ¤íŠ¸ ì•½ 3ê°œ ê°€ëŸ‰ì´ ê³„ì† ì •ë°©í–‰ë ¬, íŠ¹íˆ ëŒ€ì¹­í–‰ë ¬ì— ëŒ€í•œ ë‚´ìš©ì´ì—ˆë‹¤ë©´, ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œ í•  ë‚´ìš©ì€ ``ì§ì‚¬ê°í–‰ë ¬(rectangular matrix), ì¦‰ ì¼ë°˜ì ì¸ í–‰ë ¬``ì—ì„œ ì ìš©í•  ìˆ˜ ìˆëŠ” ë„ˆë¬´ë‚˜ë„ ì¤‘ìš”í•œ ì •ë¦¬ì— ëŒ€í•œ ê²ƒì…ë‹ˆë‹¤! ë³¸ê²©ì ìœ¼ë¡œ íŠ¹ì´ê°’ ë¶„í•´(SVD)ì— ë“¤ì–´ê°€ê¸° ì „ì— ë‹¤ìŒì˜ ì˜ˆì œë¥¼ í•˜ë‚˜ ë³´ê² ìŠµë‹ˆë‹¤. ì°¸ê³ ë¡œ, ì´ ì˜ˆì œëŠ” ë³¸ë¬¸ ì•„ë˜ì— ì°¸ê³  êµì¬ë¥¼ ì¨ë†“ì•˜ì§€ë§Œ, Linear Algebra and its Applications 7.4 p.433ì— ìˆ˜ë¡ëœ ì˜ˆì œì…ë‹ˆë‹¤.

- í–‰ë ¬ $\small A=\begin{bmatrix} 4&11&14\cr 8&7&-2\end{bmatrix}$ì€ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´, $\small \mathbb{R^n}$ì˜ ë‹¨ìœ„ êµ¬ $\small \lbrace \boldsymbol x: \lVert \boldsymbol x\rVert =1\rbrace$ë¥¼ $\small \mathbb{R^n}$ì˜ íƒ€ì›ìœ¼ë¡œ ì„ í˜•ë³€í™˜ì‹œí‚¨ë‹¤. ì´ ë•Œ, ê¸¸ì´ $\small\lVert A\boldsymbol x\rVert$ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ë‹¨ìœ„ë²¡í„° $\boldsymbol x$ë¥¼ ì°¾ê³ , ì´ ìµœëŒ€ ê¸¸ì´ë¥¼ êµ¬í•´ë¼.  
<img src="/img/svd1.png" width="670px">

ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ë©´ ì¢‹ì„ê¹Œìš”? $\small\lVert A\boldsymbol x\rVert$ë¥¼ ìµœëŒ€í™”í•˜ëŠ” $\boldsymbol x$ì—ì„œ $\small\lVert A\boldsymbol x\rVert^2$ë„ ìµœëŒ€í™”í•  ê²ƒì…ë‹ˆë‹¤. $\small\lVert A\boldsymbol x\rVert^2$ë¥¼ í’€ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë  ê²ƒì…ë‹ˆë‹¤.

\$$ \small\lVert A\boldsymbol x\rVert^2=(A\boldsymbol x)^{\intercal}(A\boldsymbol x)=\boldsymbol{x}^{\intercal}A^{\intercal}A\boldsymbol x=\boldsymbol x^{\intercal}(A^{\intercal}A)\boldsymbol x \$$

ì¦‰, $\small\boldsymbol x^{\intercal}(A^{\intercal}A)\boldsymbol x$ì„ ìµœëŒ€í™”í•˜ëŠ” ë‹¨ìœ„ë²¡í„° $\boldsymbol x$ë¥¼ ì°¾ìœ¼ë©´ ë˜ëŠ”ë°, ì´ ë•Œ $\small A^{\intercal}A$ëŠ” ëŒ€ì¹­í–‰ë ¬ì…ë‹ˆë‹¤! ì´ê±° ì–´ë””ì„œ ë§ì´ ë³´ì§€ ì•Šì•˜ë‚˜ìš”? ë°”ë¡œ [ì €ë²ˆ í¬ìŠ¤íŠ¸](https://soohee410.github.io/constrained_optimization)ì—ì„œ ë‹¨ìœ„ë²¡í„° í•˜ì—ì„œ ëŒ€ì¹­í–‰ë ¬ $A$ì˜ ì´ì°¨í˜•íƒœ(quadratic form) $\small \boldsymbol x^{\intercal}A\boldsymbol x$ì˜ ìµœëŒ“ê°’ì€ $A$ì˜ ê°€ì¥ í° ê³ ìœ ê°’ $\lambda_1$ì´ë¼ê³  í–ˆì—ˆëŠ”ë°ìš”. ë”°ë¼ì„œ, ì œì•½ì¡°ê±´ $\small \lVert \boldsymbol x\rVert=1$ í•˜ì—ì„œ $\small\boldsymbol x^{\intercal}(A^{\intercal}A)\boldsymbol x$ì˜ ìµœëŒ€ê°’ì€ $\small A^{\intercal}A$ì˜ ê°€ì¥ í° ê³ ìœ ê°’ $\lambda_1$ì…ë‹ˆë‹¤. ê·¸ëŸ°ë° ì´ ì˜ˆì œì—ì„œëŠ” $\small \lVert A\boldsymbol x\rVert$ì˜ ìµœëŒ€ê°’ì„ êµ¬í•˜ë¼ê³  í–ˆê¸° ë•Œë¬¸ì—, ë‹µì€ $\sqrt{\lambda_1}$ì´ ë  ê²ƒì…ë‹ˆë‹¤.  ë˜ í•œ, ì´ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ë‹¨ìœ„ë²¡í„° $\boldsymbol x$ëŠ” $\small A^{\intercal}A$ì˜ ê³ ìœ ê°’ $\lambda_1$ì— í•´ë‹¹í•˜ëŠ” ë‹¨ìœ„ ê³ ìœ ë²¡í„°ê°€ ë©ë‹ˆë‹¤.

<br>

## 2. íŠ¹ì´ê°’(Singular Values)ì´ë€?
<br>

$A$ê°€ mxní–‰ë ¬ì´ë¼ê³  í•´ë´…ì‹œë‹¤. ê·¸ëŸ¬ë©´ $A^{\intercal}A$ëŠ” nxn ëŒ€ì¹­í–‰ë ¬ì´ ë  ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ [ëŒ€ì¹­í–‰ë ¬ í¬ìŠ¤íŠ¸](https://soohee410.github.io/hermitian_matrix)ì—ì„œ í–ˆë“¯ì´, ëŒ€ì¹­í–‰ë ¬ $A^{\intercal}A$ëŠ” ì§êµ ëŒ€ê°í™”(orthogonally diagonalizable)ê°€ ê°€ëŠ¥í•  ê²ƒì…ë‹ˆë‹¤. ì´ì œ $\small\lbrace \boldsymbol{v_1},\boldsymbol{v_2}, \cdots,\boldsymbol{v_n} \rbrace$ì€ $\small \mathbb{R^n}$ì˜ ì§ì • ê¸°ì €(orthonormal basis)ì´ì $\small A^{\intercal}A$ì˜ ê³ ìœ ë²¡í„°ë¼ í•˜ê³ , $\small \lambda_1, \lambda_2, \cdots, \lambda_n$ì€ ê°ê° ì´ì— í•´ë‹¹í•˜ëŠ” ê³ ìœ ê°’ì´ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë©´, $\small i=1,\cdots, n$ì— ëŒ€í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

$$\small\begin{aligned} (A^{\intercal}A)\boldsymbol{v_i} &=\lambda_i\boldsymbol{v_i} \cr
\boldsymbol{v_i^{\intercal}}(A^{\intercal}A)\boldsymbol{v_i} &=\boldsymbol{v_i^{\intercal}}\lambda_i\boldsymbol{v_i} \cr
(A\boldsymbol{v_i})^{\intercal}(A\boldsymbol{v_i}) &=\lambda_i \boldsymbol{v_i^{\intercal}}\boldsymbol{v_i}\cr
\implies \lVert A\boldsymbol{v_i}\rVert ^2&=\lambda_i\lVert \boldsymbol{v_i}\rVert^2=\lambda_i\ge0\end{aligned}$$

ìœ„ ì‹ì— ì˜í•˜ì—¬, $\small A^{\intercal}A$ì˜ ëª¨ë“  ê³ ìœ ê°’ë“¤ì€ í•­ìƒ 0ì´ìƒì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  ë”°ë¼ì„œ, ì´ ê³ ìœ ê°’ë“¤ì— ë£¨íŠ¸ë¥¼ ì”Œìš¸ ìˆ˜ ìˆê²Œ ë˜ê³ , ë‹¤ìŒê³¼ ê°™ì´ ê³ ìœ ê°’ë“¤ì— ë£¨íŠ¸ë¥¼ ì”Œìš´ ê²ƒ($\sigma_i$)ì„ ë°”ë¡œ $A$ì˜ **íŠ¹ì´ê°’(singular value)** ì´ë¼ê³  í•©ë‹ˆë‹¤.

$$\small\sigma_i=\sqrt{\lambda_i},\quad for\space 1\le i\le n$$

ì¦‰, $A$ì˜ íŠ¹ì´ê°’ $\sigma_i$ëŠ” ë²¡í„° $\small A\boldsymbol{v_i}$ì˜ ê¸¸ì´ë¥¼ ì˜ë¯¸í•˜ê²Œ ë©ë‹ˆë‹¤.

íŠ¹ì´ê°’ë“¤ì€ í•­ìƒ 0ì´ë¼ëŠ” ê²ƒì„ ì•Œì•˜ìŠµë‹ˆë‹¤. ì´ì œ nê°œì˜ íŠ¹ì´ê°’ì„ ê·¸ ê°’ì´ í° ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•´ë´…ì‹œë‹¤. ê·¸ëŸ¬ë©´ ì–´ë–¤ $\small 0\le r\le n$ì— ëŒ€í•˜ì—¬, $\sigma_r$ ì´í›„ë¶€í„°ëŠ” 0ì´ ë  ìˆ˜ë„ ìˆì„ ê²ƒì…ë‹ˆë‹¤. 0ì´ ê³ ìœ ê°’ì´ ë˜ëŠ” ê²½ìš°ë„ ë§ì£ ? íŠ¹ì´ê°’ì´ 0ì´ ë˜ëŠ” ë¶€ë¶„ê³¼ ì•„ë‹Œ ë¶€ë¶„ì„ ì¼ë°˜í™”í•´ì„œ ì •ì˜í•˜ê³ ì ì„ì˜ì˜ ìƒìˆ˜ $r$ë¶€í„°ëŠ” 0ì´ë¼ê³  í•´ë³´ê² ìŠµë‹ˆë‹¤.

$$\small\sigma_1\ge\sigma_2\ge\cdots\sigma_r >0=\sigma_{r+1}=\cdots
=\sigma_n $$

ì´ ê²½ìš°ë¥¼ ë‹¤ì‹œ í‘œí˜„í•˜ë©´, $\small \lVert A\boldsymbol{v_{r+1}}\rVert=\cdots =\lVert A\boldsymbol{v_n}\rVert=0$ì´ ëœë‹¤ëŠ” ê²ƒì´ê³ , ì¦‰  $\small A\boldsymbol{v_{r+1}}=\cdots=A\boldsymbol{v_n}=0 $ì´ ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ì œ ê·¸ë ‡ë‹¤ë©´, $r$ê°œì˜ 0ì´ ì•„ë‹Œ íŠ¹ì´ê°’ë“¤ì— ëŒ€í•´, $\small A\boldsymbol{v_1},\cdots,A\boldsymbol{v_r}$ë„ 0ì´ ì•„ë‹ í…ë°ìš”. ì´ë“¤ì€ ì–´ë–¤ ì—­í• ì„ í• ê¹Œìš”? ì´ì™€ ê´€ë ¨í•˜ì—¬ ì•„ë˜ì˜ ì •ë¦¬ë¥¼ ë´…ì‹œë‹¤.

>**Thm.** $\small A^{\intercal}A$ì˜ ê³ ìœ ë²¡í„°ë¡œ ì´ë£¨ì–´ì§„ $\small \lbrace \boldsymbol{v_1},\cdots,\boldsymbol{v_n}\rbrace$ì´ $\small \mathbb{R^n}$ì˜ ì§ì • ê¸°ì €(orthonormal basis)ë¼ê³  í•˜ê³ , $A$ê°€ rê°œì˜ 0ì´ ì•„ë‹Œ íŠ¹ì´ê°’ë“¤ì„ ê°€ì§€ê³  ìˆë‹¤ê³  í•˜ì. ê·¸ëŸ¬ë©´,  $\small \lbrace A\boldsymbol{v_1},\cdots, A\boldsymbol{v_n} \rbrace$ì´ $\small Col(A)$ì˜ ì§êµ ê¸°ì €(orthogonal basis)ê°€ ë  ê²ƒì´ë©°, $\small rank(A)=r$ì´ ë  ê²ƒì´ë‹¤.

ê°„ë‹¨íˆ ì¦ëª…í•´ ë´…ì‹œë‹¤. ë¨¼ì € $i\not =j$ì¼ ë•Œ, $\small \boldsymbol{v_i}$ì™€ $\small \lambda_j\boldsymbol{v_j}$ëŠ” ì„œë¡œ ì§êµí•˜ê¸° ë•Œë¬¸ì—, ë‹¤ìŒê³¼ ê°™ì´ $A\boldsymbol{v_i}$ì™€ $A\boldsymbol{v_j}$ëŠ” ì„œë¡œ ì§êµí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

$$\small(A\boldsymbol{v_i})^{\intercal}(A\boldsymbol{v_j})=\boldsymbol{v_i}^{\intercal}A^{\intercal}A\boldsymbol{v_j}=\boldsymbol{v_i}^{\intercal}(\lambda_j\boldsymbol{v_j})=0 $$

ë”°ë¼ì„œ $\small \lbrace A\boldsymbol{v_1},\cdots,A\boldsymbol{v_n}\rbrace$ëŠ” ì§êµ ì§‘í•©ì…ë‹ˆë‹¤. ì´ì œ ì´ ì§‘í•©ì´ $\small Col(A)$ì˜ ê¸°ì €ë¼ëŠ” ê²ƒì„ ë³´ì—¬ì•¼ í•˜ëŠ”ë°ìš”. ì–´ë–¤ ì„ì˜ì˜ ë²¡í„° $\small \boldsymbol{x}\in\mathbb{R^n}$ì— ëŒ€í•´, $\small\boldsymbol y=A\boldsymbol x$ë¼ê³  í•œë‹¤ë©´, ë²¡í„° $\small\boldsymbol y\in Col(A)$ê°€ ë  ê²ƒì…ë‹ˆë‹¤. í•œí¸, ë²¡í„° $\boldsymbol x$ëŠ” $\small\boldsymbol x=c_1\boldsymbol{v_1}+\cdots+c_n\boldsymbol{v_n}$ê³¼ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì´ ë•Œ, rê°œì˜ íŠ¹ì´ê°’ë“¤ì´ 0ì´ ì•„ë‹ˆë¼ê³  í–ˆìœ¼ë¯€ë¡œ, $\small 1\le i\le r$ì— ëŒ€í•´ì„œëŠ” $\small A\boldsymbol{v_i}\not= 0$ì´ ë  ê²ƒì…ë‹ˆë‹¤.

$$\small\begin{aligned} \boldsymbol y&=A\boldsymbol x =c_1A\boldsymbol{v_1}+\cdots+c_rA\boldsymbol{v_r}+c_{r+1}A \boldsymbol{v_{r+1}}+\cdots+c_nA\boldsymbol{v_n}\cr
&=c_1A\boldsymbol{v_1}+\cdots+c_rA\boldsymbol{v_r}+0+\cdots+0\end{aligned}$$

ë”°ë¼ì„œ $\boldsymbol y \in\small Span\lbrace A\boldsymbol{v_1},\cdots, A\boldsymbol{v_r}\rbrace$ê°€ ë˜ê³ , $\small \lbrace A\boldsymbol{v_1},\cdots, A\boldsymbol{v_r}\rbrace$ì€ $\small Col(A)$ì˜ ì§êµ ê¸°ì €ê°€ ë©ë‹ˆë‹¤. ë˜ í•œ, $\small rank(A)=din(Col(A))=r$ì´ ë©ë‹ˆë‹¤.

<img src="/img/svd2.png" width="600px">

<br>


## 3. íŠ¹ì´ê°’ ë¶„í•´(Singular Value Decomposition)
<br>

ë³¸ê²©ì ìœ¼ë¡œ íŠ¹ì´ê°’ ë¶„í•´ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ì •ë¦¬ë¶€í„° ì½ì–´ë´…ì‹œë‹¤.

>**Thm. The Singular Value Decomposition**
$A$ê°€ rankê°€ rì¸ mxn í–‰ë ¬ì´ë¼ê³  í•˜ì. ê·¸ëŸ¬ë©´, mxm ì§êµ í–‰ë ¬(orthogonal matrix) $U$ì™€  nxn ì§êµí–‰ë ¬ $V$, ê·¸ë¦¬ê³  mxní–‰ë ¬ $\Sigma$ê°€ ì¡´ì¬í•˜ì—¬ í–‰ë ¬ $A$ê°€ ë‹¤ìŒê³¼ ê°™ì´ ë¶„í•´ëœë‹¤: $A=U\Sigma V^{\intercal}$  
ì´ ë•Œ, í–‰ë ¬ $\Sigma$ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ëŒ€ê°ìš”ì†Œê°€ $A$ì˜ rê°œì˜ íŠ¹ì´ê°’ë“¤ì¸ ëŒ€ê°í–‰ë ¬ $D$ì™€ ë‚˜ë¨¸ì§€ëŠ” 0ì¸ ìš”ì†Œë“¤ë¡œ ì´ë£¨ì–´ì§„ë‹¤.
$$\small\Sigma=\begin{bmatrix} D &0\cr 0&0\end{bmatrix},\space D=\begin{bmatrix} \sigma_1&&0\cr &\ddots&\cr 0 & &\sigma_r\end{bmatrix}$$

$\small A=U\Sigma V^{\intercal}$ì™€ ê°™ì´ ë¶„í•´í•˜ëŠ” ê²ƒì„ í–‰ë ¬ $A$ì˜ íŠ¹ì´ê°’ ë¶„í•´(SVD)ë¼ê³  í•˜ëŠ”ë°ìš”. ì´ ë•Œ, í–‰ë ¬ $U$ì™€ $V$ëŠ” ìœ ì¼í•œ(unique) ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, $\Sigma$ì˜ ëŒ€ê°ìš”ì†Œ ì¤‘ ì²« rê°œëŠ” $A$ì˜ íŠ¹ì´ê°’ìœ¼ë¡œ ìœ ì¼í•˜ê²Œ ì •í•´ì§‘ë‹ˆë‹¤.  

ì´ì œ ì´ ì •ë¦¬ë¥¼ ì¦ëª…í•´ë´…ì‹œë‹¤. 2ë²ˆì—ì„œ í–ˆë˜ ì •ë¦¬ì™€ ì¦ëª…ì„ ì¡°ê¸ˆ ê°–ë‹¤ ì“¸ ê±´ë°ìš”. 2ë²ˆì—ì„œ í–ˆë˜ ì •ë¦¬ì—ì„œ ê°€ì •í•œ ê²ƒê³¼ ê°™ì´, $\small \lbrace \boldsymbol{v_1},\cdots,\boldsymbol{v_n}\rbrace$ì´ $\small\mathbb{R^n}$ì˜ ì§ì • ê¸°ì €ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ ì •ë¦¬ì— ì˜í•´, $\small\lbrace A\boldsymbol{v_1},\cdots,A\boldsymbol{v_r}\rbrace$ëŠ” $\small Col(A)$ì˜ ì§êµ ê¸°ì €ì…ë‹ˆë‹¤. ì´ì œ ì´ ë²¡í„°ë“¤ì„ ê°ê°ì˜ ê¸¸ì´ë¡œ ë‚˜ëˆ„ì–´ì„œ ì§ì • ê¸°ì € $\small\lbrace \boldsymbol{u_1},\cdots,\boldsymbol{u_r}\rbrace$ë¥¼ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

$$\small\begin{gathered}\boldsymbol{u_i}=\frac{1}{\lVert A\boldsymbol{v_i}\rVert}A\boldsymbol{v_i}=\frac{1}{\sigma_i}A
\boldsymbol{v_i} \cr \implies A\boldsymbol{v_i}=\sigma_i\boldsymbol{u_i},\space (1\le i\le r) \end{gathered}$$

ì´ì œ $\small \lbrace \boldsymbol{u_1},\cdots,\boldsymbol{u_r}\rbrace$ì„ í™•ì¥í•˜ì—¬ $\mathbb{R^m}$ì˜ ì§ì • ê¸°ì €  $\small \lbrace \boldsymbol{u_1},\cdots,\boldsymbol{u_m}\rbrace$ì„ ì–»ê³ , ë‹¤ìŒê³¼ ê°™ì´ ì´ ë²¡í„°ë“¤ì„ í–‰ë ¬ë¡œ í‘œí˜„í•˜ì—¬ ì´ë“¤ì„ ê°ê° $U$ì™€ $V$ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤.

$$\small U=\begin{bmatrix} \boldsymbol u_1&\cdots&\boldsymbol u_m\end{bmatrix},\quad V=\begin{bmatrix}\boldsymbol v_1&\cdots&\boldsymbol v_n\end{bmatrix}$$

ì´ ë•Œ, ë‘ í–‰ë ¬ì˜ ê³± $\small AV$ëŠ” ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

$$\small\begin{aligned} AV&=\begin{bmatrix} A\boldsymbol v_1 &\cdots&A\boldsymbol v_r &A\boldsymbol v_{r+1}&\cdots&A\boldsymbol v_n \end{bmatrix}\cr
 &=\begin{bmatrix} A\boldsymbol v_1 &\cdots&A\boldsymbol v_r &\boldsymbol 0&\cdots&\boldsymbol 0 \end{bmatrix}\cr
 &=\begin{bmatrix} \sigma_1\boldsymbol u_1 &\cdots& \sigma_r \boldsymbol u_r &\boldsymbol 0&\cdots&\boldsymbol 0 \end{bmatrix} \end{aligned}$$

í•œí¸ $\small U\Sigma$ëŠ” ì–´ë–»ê²Œ ë ê¹Œìš”?

$$\small \begin{aligned} U\Sigma&=\begin{bmatrix} \boldsymbol u_1 &\cdots & \boldsymbol u_m \end{bmatrix}\begin{bmatrix} \begin{array}{ccc|c}\sigma_1&&0&\cr
&\ddots&&\boldsymbol 0\cr 0 &&\sigma_r&\cr
\hline & \boldsymbol 0 & &\boldsymbol 0\end{array}\end{bmatrix}\cr
&=\begin{bmatrix} \sigma_1\boldsymbol u_1 &\cdots& \sigma_r \boldsymbol u_r &\boldsymbol 0&\cdots&\boldsymbol 0 \end{bmatrix}\cr &=AV\end{aligned}$$

ë”°ë¼ì„œ í–‰ë ¬ $V$ëŠ” ì§êµí–‰ë ¬ì´ë¯€ë¡œ, $A$ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë¶„í•´ê°€ ë©ë‹ˆë‹¤.

$$\small AV=U\Sigma \implies A=U\Sigma V^{\intercal}$$

<br>ì´í•´ê°€ ë˜ì…¨ë‚˜ìš”? í–‰ë ¬ $V$ì™€ $U$ì— ëŒ€í•´ ë” ì•Œì•„ë´…ì‹œë‹¤. ì¼ë‹¨ í–‰ë ¬ $A$ë¥¼ transposeí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë  ê²ƒì…ë‹ˆë‹¤.

$$\small A=U\Sigma V^{\intercal},\quad A^{\intercal}=V\Sigma^{\intercal} U^{\intercal}$$

ì´ì œ, $\small A^{\intercal}A$ì„ ê³„ì‚°í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë  ê²ƒì…ë‹ˆë‹¤. ì´ ë•Œ, $\small \Sigma^{\intercal}\Sigma$ì€ ì²« ëŒ€ê°ìš”ì†Œê°€ rê°œì˜ $\small \lambda_i=\sigma_i^2$ì´ê³  ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ 0ìœ¼ë¡œ ì´ë£¨ì–´ì§„ nxn ëŒ€ê°í–‰ë ¬ì´ ë  ê²ƒì´ê³ , ì´ë¥¼ $D$ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤.

$$\small\begin{aligned}A^{\intercal}A&=V\Sigma^{\intercal} U^{\intercal}U\Sigma V^{\intercal}=V\Sigma^{\intercal}\Sigma V^{\intercal}\cr
&=V\begin{bmatrix} \begin{array}{ccc|c}\lambda_1&&0&\cr
&\ddots&&\boldsymbol 0_{\sf (n-r)xr}\cr 0 &&\lambda_r&\cr
\hline & \boldsymbol 0_{\sf r x (n-r)} & &\boldsymbol 0\end{array}\end{bmatrix}V^{\intercal}=VDV^{\intercal}\cr
&\implies (A^{\intercal}A)V=VD\end{aligned}$$

ì¦‰, ìœ„ì—ì„œ ìµœì¢…ì ìœ¼ë¡œ ë„ì¶œë˜ëŠ” ì‹ì— ì˜í•´ í–‰ë ¬ $V$ëŠ” $\small A^{\intercal}A$ì˜ ê³ ìœ ë²¡í„° í–‰ë ¬ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ëŒ€ë¡œ $\small AA^{\intercal}$ì„ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë  ê²ƒì´ê³ , ì´ë²ˆì—” $\small \Sigma\Sigma^{\intercal}$ì´ ì²« ëŒ€ê°ìš”ì†Œê°€ rê°œì˜ $\small \lambda_i=\sigma_i^2$ì´ê³  ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ 0ìœ¼ë¡œ ì´ë£¨ì–´ì§„ mxm ëŒ€ê°í–‰ë ¬ $D'$ê°€ ë  ê²ƒì…ë‹ˆë‹¤.

$$\small \begin{aligned}AA^{\intercal}&=U\Sigma V^{\intercal}V\Sigma^{\intercal} U^{\intercal}=U\Sigma\Sigma^{\intercal}U^{\intercal}=UD'U^{\intercal}\cr
&\implies (AA^{\intercal})U=UD' \end{aligned}$$

ë”°ë¼ì„œ, ìœ„ ì‹ì— ì˜í•´ í–‰ë ¬ $U$ëŠ” $AA^{\intercal}$ì˜ ê³ ìœ ë²¡í„° í–‰ë ¬ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

<br>

## 4. Reduced SVDì™€ Pseudoinverse
<br>

ì§€ê¸ˆê¹Œì§€ SVDì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ëŠ”ë°ìš”. ê³„ì‚° ë¬¸ì œë¥¼ ì¡°ê¸ˆ í’€ì–´ë³´ë©´ ì•„ì‹œê² ì§€ë§Œ, mxní–‰ë ¬ $A$ì— ëŒ€í•˜ì—¬ íŠ¹ì´ê°’ì´ 0ì¸ ê²ƒì´ ì¡´ì¬í•˜ê²Œ ë˜ë©´, ë‹¤ë¥¸ ë§ë¡œ $\small rank(A)<min(m,n)$ì¸ ê²½ìš°ì—ëŠ” ê³„ì‚° ê³¼ì •ì—ì„œ 0ì´ ë˜ëŠ” ë¶€ë¶„ì´ ë§¤ìš° ë§ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì²˜ìŒë¶€í„° ì´ 0ì´ ë˜ëŠ” ë¶€ë¶„ì„ ì œê±°í•˜ê³  ê³„ì‚°í•˜ë©´ ì¡°ê¸ˆì€ ë” ê°„ë‹¨í•´ì§ˆ ìˆ˜ ìˆê² ì£ ? ì´ì œ $\small r=Rank(A)$ë¼ê³  í•©ì‹œë‹¤. ê·¸ëŸ¬ë©´, í–‰ë ¬ $U$ì™€ $V$ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‘ ë¸”ëŸ­ìœ¼ë¡œ ìª¼ê°¤ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

$$\small \begin{aligned} U&=\begin{bmatrix} U_r&U_{m-r} \end{bmatrix}, \quad U_r=\begin{bmatrix} \boldsymbol u_1 & \cdots \boldsymbol u_r\end{bmatrix}\cr
V&=\begin{bmatrix} V_r&V_{n-r} \end{bmatrix}, \quad V_r=\begin{bmatrix} \boldsymbol v_1 & \cdots \boldsymbol v_r\end{bmatrix}
\end{aligned}$$

ì´ ë•Œ, SVD ì •ë¦¬ë¥¼ ì ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ $\small U_rDV_r^{\intercal}$ë§Œ ë‚¨ì„ ê²ƒì…ë‹ˆë‹¤.

$$\small A=\begin{bmatrix} U_r&U_{m-r} \end{bmatrix}\begin{bmatrix} D_{\sf rxr}&0\cr0&0\end{bmatrix}\begin{bmatrix} V_r^{\intercal}\cr V_{n-r}^{\intercal}\end{bmatrix}=U_rDV_r^{\intercal}$$

ì´ë ‡ê²Œ $A$ë¥¼ ë¶„í•´í•˜ëŠ” ê²ƒì„ $A$ì˜ **Reduced Singular Value Decomposition** ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. ì´ë ‡ê²Œ ë¶„í•´í•˜ë©´ ì—„ì²­ë‚œ ì¥ì ì´ ìƒê¸°ëŠ”ë°ìš”. ë°”ë¡œ ``í–‰ë ¬ Aì˜ ì—­í–‰ë ¬ì„ êµ¬í•  ìˆ˜ ìˆë‹¤``ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒì˜ í–‰ë ¬ $\small A^{+}$ì„ ë°”ë¡œ **pseudoinverse** ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤!

$$\small \begin{gathered}A^+=V_rD^{-1}U_r^{\intercal}\cr
(AA^+=A^+A=I)\end{gathered}$$

ì´ë ‡ê²Œ í–‰ë ¬ $A$ì˜ ì—­í–‰ë ¬ì„ êµ¬í•  ìˆ˜ ìˆê²Œ ë˜ë©´ ë§ì€ ê²ƒì„ í•  ìˆ˜ ìˆê²Œ ë˜ëŠ”ë°ìš”. ê·¸ ì¤‘ì—ì„œë„ $\small A\boldsymbol x=\boldsymbol b$ì™€ ê°™ì€ ë°©ì •ì‹ì— ëŒ€í•œ í•´ë„ ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì— ëŒ€í•œ ë‚´ìš©ì€ [ìµœì†Œì œê³±í•´](https://soohee410.github.io/least_squares_sol)ì— ëŒ€í•œ í¬ìŠ¤íŠ¸ì—ì„œ ë§ì´ ë‹¤ë¤˜ëŠ”ë°ìš”. SVDë¥¼ ì´ìš©í•˜ê²Œ ë˜ë©´, íŠ¹ë³„í•œ ì¡°ê±´ì´ ì—†ëŠ” ì§ì‚¬ê°í–‰ë ¬ì— ëŒ€í•´ì„œë„ ìµœì†Œì œê³±í•´ë¥¼ ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

$$\small \boldsymbol{\hat x}=A^+\boldsymbol b=V_rD^{-1}U_r^{\intercal}\boldsymbol b$$

<br>

ì—¬ê¸°ê¹Œì§€ êµ‰ì¥íˆ í™œìš©ë„ê°€ ë†’ì€ íŠ¹ì´ê°’ ë¶„í•´ì— ëŒ€í•œ ë‚´ìš©ì´ì—ˆìŠµë‹ˆë‹¤! ê°ì‚¬í•©ë‹ˆë‹¤ :)

<br>

---
$Reference.$  
- David C.Lay Â· Stephen R.Lay Â· Judi J.McDonald, Linear Algebra and its Applications, 5th edition, Pearson
- ê³ ë ¤ëŒ€í•™êµ ê¹€í™ì¤‘ êµìˆ˜ë‹˜ì˜ ìˆ˜ì—…

<br>
